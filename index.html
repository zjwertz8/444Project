<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Heatmaps</title>
    <link rel="stylesheet" href="stylesheets/styles.css">
    <script src="http://maps.google.com/maps/api/js?sensor=True"></script>

  </head>
<body>
<h1>Ole Miss Parking Citation Visualization</h1>
<script type="text/javascript" src="d3.min.js"></script>
<script type="text/javascript" src="d3/d3.min.js"></script>
<div id="map-container">
<div id="map"></div>
<script>

var map = new google.maps.Map(d3.select("#map").node(), {
               zoom: 15,
               center: new google.maps.LatLng(34.364732, -89.538443),
               mapTypeId: google.maps.MapTypeId.ROADMAP
             });


d3.csv("Demo1.csv", function(data) {
  var lotCount = d3.nest()
     .key(function(d) {return d.CLM_DESCRIPTION;})
     .rollup(function(v) { return v.length;})
     .entries(data)

  console.log(lotCount)
  // console.log(lotCount[0])
  console.log(lotCount[0].key)


var gradient = d3.scaleLinear().domain([0,10]).range(["green", "red"]);


//function to find key in array, give correct fill color
function fillColor(lotCount, param)
{
  for(i = 0; i < lotCount.length; i++)
  {

  if(lotCount[i].key == param)
    {
      return lotCount[i].value;
    }
  }
}

//Jackson Avenue
jacksonAveLatLong =
[
{"lat": 34.36998163682145, "lng":-89.54804563509242},
{"lat": 34.370610387879836, "lng": -89.54699420915858},
{"lat": 34.37082735017804, "lng": -89.54631829248683},
{"lat": 34.37082292238164, "lng": -89.54574966417567},
{"lat": 34.37081406678818, "lng": -89.54507374750392},
{"lat": 34.370495264799516, "lng": -89.54488062845485},
{"lat": 34.37042441974841, "lng": -89.54491817938106},
{"lat": 34.37037128592073, "lng": -89.54498791681544},
{"lat": 34.36889680875947, "lng": -89.54835677133815},
{"lat": 34.368914520350835, "lng": -89.54849624620692},
{"lat": 34.36898979457238, "lng": -89.54860353456752},
{"lat": 34.36945029421982, "lng": -89.54886102663295},
{"lat": 34.369746960921255, "lng": -89.54881811128871},
{"lat": 34.36955213514621, "lng": -89.54840505110042},
{"lat": 34.36998075126676, "lng": -89.5480477809906}
];

//Crosby Rear
crosyRearLatLong = [
  {"lat": 34.369766, "lng": -89.534701},
  {"lat": 34.370179, "lng": -89.534662},
  {"lat": 34.370126, "lng": -89.535075},
  {"lat": 34.370226, "lng": -89.535105},
  {"lat": 34.370354, "lng": -89.535094},
  {"lat": 34.371093, "lng": -89.534949},
  {"lat": 34.371634, "lng": -89.534853},
  {"lat": 34.371532, "lng": -89.534051},
  {"lat": 34.371321, "lng": -89.534088},
  {"lat": 34.371271, "lng": -89.533756},
  {"lat": 34.37075, "lng": -89.533866},
  {"lat": 34.370788, "lng": -89.534193},
  {"lat": 34.370206, "lng": -89.534273},
  {"lat": 34.37018, "lng": -89.534661}
];

//Stockard Rear
stockardRearLatLong = [
  {"lat": 34.370356, "lng": -89.53791},
  {"lat": 34.370093, "lng": -89.537935},
  {"lat": 34.369789, "lng": -89.538047},
  {"lat": 34.369513, "lng": -89.537318},
  {"lat": 34.369475, "lng": -89.537076},
  {"lat": 34.369471, "lng": -89.53676},
  {"lat": 34.369648, "lng": -89.536148},
  {"lat": 34.370084, "lng": -89.536052},
  {"lat": 34.370432, "lng": -89.535987},
  {"lat": 34.370456, "lng": -89.536559},
  {"lat": 34.370432, "lng": -89.537739}
];

PoolDriveLatLong =[
{"lat":  34.3643414845513, "lng": -89.5434434339404},
{"lat":  34.3643077199841, "lng": -89.5433374866843},
{"lat":  34.3642673131891, "lng": -89.5432094112038},
{"lat":  34.3642424048811, "lng": -89.5431289449334},
{"lat":  34.3641914812062, "lng": -89.5429706946015},
{"lat":  34.3641422180565, "lng": -89.5428131148219},
{"lat":  34.3641040252575, "lng": -89.5426957681775},
{"lat":  34.3640735817096, "lng": -89.5425951853394},
{"lat":  34.364050333902, "lng": -89.542517401278},
{"lat":  34.3640287466463, "lng": -89.5424436405301},
{"lat":  34.364004391787, "lng": -89.5423638448119},
{"lat":  34.3639866791576, "lng": -89.542306177318},
{"lat":  34.3639661989252, "lng": -89.5422357693314},
{"lat":  34.3639501468477, "lng": -89.5421814545989},
{"lat":  34.3639263454857, "lng": -89.5421003177762},
{"lat":  34.3638997765155, "lng": -89.5419997349381},
{"lat":  34.3638704399175, "lng": -89.5418669655919},
{"lat":  34.3638388892433, "lng": -89.5417362079024},
{"lat":  34.3638134272871, "lng": -89.541629590094},
{"lat":  34.3637912864494, "lng": -89.5415323600172},
{"lat":  34.3637757878594, "lng": -89.5414626225829},
{"lat":  34.3637680385634, "lng": -89.5414257422089},
{"lat":  34.3637608427879, "lng": -89.5413855090737},
{"lat":  34.3637270779867, "lng": -89.5411970838904},
{"lat":  34.3637054906477, "lng": -89.5410623028874},
{"lat":  34.3636595483436, "lng": -89.5407846942543},
{"lat":  34.3636385145093, "lng": -89.5406693592667},
{"lat":  34.3636246764575, "lng": -89.5405546948313},
{"lat":  34.3636102848811, "lng": -89.5404594764113},
{"lat":  34.3636003214807, "lng": -89.5403957739472},
{"lat":  34.3635898045567, "lng": -89.540318660438},
{"lat":  34.3635815017211, "lng": -89.54026568681},
{"lat":  34.3635759664969, "lng": -89.5402153953909},
{"lat":  34.3635726453622, "lng": -89.5401845499873},
{"lat":  34.3635682171824, "lng": -89.5401657745242},
{"lat":  34.3635648960474, "lng": -89.5401302352547},
{"lat":  34.3635621284348, "lng": -89.5400873199105},
{"lat":  34.3635626819573, "lng": -89.5400484278798},
{"lat":  34.3635637890023, "lng": -89.540004171431},
{"lat":  34.3635676636599, "lng": -89.5399773493409},
{"lat":  34.3635792876315, "lng": -89.5399277284741},
{"lat":  34.3636053031811, "lng": -89.5398532971739},
{"lat":  34.3636329792888, "lng": -89.5397828891873},
{"lat":  34.3636617624312, "lng": -89.5397064462304},
{"lat":  34.3636960807803, "lng": -89.5396139100193},
{"lat":  34.3637160075572, "lng": -89.5395595952868},
{"lat":  34.3637508794053, "lng": -89.539465047419},
{"lat":  34.3637951610964, "lng": -89.5393376424908},
{"lat":  34.363856601904, "lng": -89.5391659811139},
{"lat":  34.3639019905966, "lng": -89.5390379056334},
{"lat":  34.3639313271667, "lng": -89.5389594510197},
{"lat":  34.3639833580392, "lng": -89.5388803258538},
{"lat":  34.3640315142435, "lng": -89.5388246700167},
{"lat":  34.3640802239392, "lng": -89.538783095777},
{"lat":  34.3641145421169, "lng": -89.5387576147913},
{"lat":  34.3641560560228, "lng": -89.5387321338057},
{"lat":  34.3642324415559, "lng": -89.5386999472975},
{"lat":  34.3642905609365, "lng": -89.5386764779686},
{"lat":  34.3643453591728, "lng": -89.5386556908488},
{"lat":  34.364384658896, "lng": -89.5386395975947},
{"lat":  34.3644206374996, "lng": -89.5386255159974},
{"lat":  34.3644117812294, "lng": -89.5385866239666},
{"lat":  34.364366946347, "lng": -89.538603387773},
{"lat":  34.3642390837728, "lng": -89.5386550202965},
{"lat":  34.3641964628715, "lng": -89.5386711135506},
{"lat":  34.3641355758318, "lng": -89.5386979356408},
{"lat":  34.3640874196873, "lng": -89.5387267693877},
{"lat":  34.3640414775926, "lng": -89.5387670025229},
{"lat":  34.3640049453066, "lng": -89.5388018712401},
{"lat":  34.3639689665245, "lng": -89.5388421043753},
{"lat":  34.3639257919487, "lng": -89.5388957485556},
{"lat":  34.3638881525714, "lng": -89.538970850408},
{"lat":  34.363853834301, "lng": -89.5390687510371},
{"lat":  34.3638067850364, "lng": -89.5392001792788},
{"lat":  34.3637719132115, "lng": -89.5393027737736},
{"lat":  34.363723756858, "lng": -89.5394388958811},
{"lat":  34.3636744934333, "lng": -89.5395743474364},
{"lat":  34.3636136060144, "lng": -89.539737291634},
{"lat":  34.3635687707049, "lng": -89.5398600026965},
{"lat":  34.3635416480986, "lng": -89.5399257168173},
{"lat":  34.3635338987809, "lng": -89.5399659499526},
{"lat":  34.3635294705991, "lng": -89.5400558039546},
{"lat":  34.3635405410533, "lng": -89.5402033254504},
{"lat":  34.3635560396867, "lng": -89.5403320714831},
{"lat":  34.3635920186461, "lng": -89.5405674353241},
{"lat":  34.3636279975901, "lng": -89.5408061519265},
{"lat":  34.3636562272122, "lng": -89.5409798249602},
{"lat":  34.363694973737, "lng": -89.5412131771445},
{"lat":  34.3637243103795, "lng": -89.5413808152079},
{"lat":  34.3637813230705, "lng": -89.5416403189301},
{"lat":  34.3638206230582, "lng": -89.54180393368},
{"lat":  34.363895348336, "lng": -89.5421123877167},
{"lat":  34.3639440581278, "lng": -89.5422813668847},
{"lat":  34.3640066058654, "lng": -89.542485885322},
{"lat":  34.3640901872826, "lng": -89.5427614822983},
{"lat":  34.3641538419484, "lng": -89.5429613068699},
{"lat":  34.3642125149018, "lng": -89.5431457087397},
{"lat":  34.3642662061533, "lng": -89.5433187112212},
{"lat":  34.3642900074188, "lng": -89.5433931425213},
{"lat":  34.3643082735017, "lng": -89.5434514805674},
{"lat":  34.3643415347275, "lng": -89.5434425603305}
];



jacksonAvePoly = new google.maps.Polygon({
  paths: jacksonAveLatLong,
  strokeColor: '#FF0000',
  strokeOpacity: 0.8,
  strokeWeight: 0,
  // fillColor: gradient(10),
  fillColor: gradient(fillColor(lotCount, "15 MINUTE FORD CENTER")),
  fillOpacity: 0.35
});

crosbyRearPoly = new google.maps.Polygon({
  paths: crosyRearLatLong,
  strokeColor: '#FF0000',
  strokeOpacity: 0.8,
  strokeWeight: 0,
  // fillColor: gradient(10),
  fillColor: gradient(fillColor(lotCount, "15 MINUTE FORD CENTER")),
  fillOpacity: 0.35
});

stockardRearPoly = new google.maps.Polygon({
  paths: stockardRearLatLong,
  strokeColor: '#FF0000',
  strokeOpacity: 0.8,
  strokeWeight: 0,
  // fillColor: gradient(10),
  fillColor: gradient(fillColor(lotCount, "15 MINUTE FORD CENTER")),
  fillOpacity: 0.35
});

parkingLotCoords2 = [
{"lat": 34.369858, "lng": -89.544057},
{"lat": 34.368981, "lng": -89.544947},
{"lat": 34.368193, "lng": -89.544121},
{"lat": 34.368131, "lng": -89.545097}
];


 jacksonAve2 = new google.maps.Polygon({
  paths: parkingLotCoords2,
  strokeColor: '#FF0000',
  strokeOpacity: 0.8,
  strokeWeight: 0,
  fillColor: gradient(2),
  fillOpacity: 0.35
 })

  jacksonAvePoly.setMap(map);
  jacksonAve2.setMap(map);
  crosbyRearPoly.setMap(map);
  stockardRearPoly.setMap(map);

});
</script>
</div>
  </body>
</html>
