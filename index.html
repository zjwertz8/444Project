  <!DOCTYPE html>
  <html>
    <head>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Ole Miss Parking Citation Visualization</title>
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.6/css/bootstrap.min.css">
      <link rel="stylesheet" href="stylesheets/styles.css">
      <script src="http://maps.google.com/maps/api/js?sensor=True"></script>
    </head>
  <body>
  <h1>Ole Miss Parking Citation Visualization </h1>

  <script type="text/javascript" src="d3.min.js"></script>
  <script type="text/javascript" src="d3/d3.min.js"></script>
  <script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>
  <script type="text/javascript" src="scripts/globalLatLng.js"></script>
  <div id="map-container">
  <div id="map"></div>
  <button type="button" class="btn btn-primary btn-lg active" id="myButton">Compare Parking lots</button>
  <script>

  var map = new google.maps.Map(d3.select("#map").node(), {
                 zoom: 15,
                 center: new google.maps.LatLng(34.364732, -89.538443),
                 mapTypeId: google.maps.MapTypeId.ROADMAP
               });

  //array of existing polygons
  var existingPolygons = [];



  d3.csv("FullDataRaw.csv", function(data) {
   
    //rollup with parking lot
    var lotsRolledUp = d3.nest()
    .key(function(d) {return d.CLM_DESCRIPTION;})
    .rollup(function(v) {return v.length;})
    .entries(data)

    //rollup with parking lot and year
    var lotsRolledUpY = d3.nest()
    .key(function(d) {return d.CLM_DESCRIPTION;})
    .key(function(d) {return d.Year;})
    .rollup(function(v) {return v.length;})
    .entries(data)
    
    //rollup with parking lot and year and month
    var lotsRolledUpM = d3.nest()
    .key(function(d) {return d.CLM_DESCRIPTION;})
    .key(function(d) {return d.Year;})
    .key(function(d) {return d.Month;})
    .rollup(function(v) {return v.length;})
    .entries(data)

    //rollup with parking lot and year and month and day
    var lotsRolledUpD = d3.nest()
    .key(function(d) {return d.CLM_DESCRIPTION;})
    .key(function(d) {return d.Year;})
    .key(function(d) {return d.Month;})
    .key(function(d) {return d.Day;})
    .rollup(function(v) {return v.length;})
    .entries(data)

  console.log(lotsRolledUp);
  console.log(lotsRolledUpY);
  console.log(lotsRolledUpM);
  console.log(lotsRolledUpD);


  var years = ["All", "2014", "2015", "2016", "2017"];

  var months = ["All", "January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];
  var days = ["All"];

  //dictionary for corresponding month day
  var monthDict = {
    "January" : 1,
    "February" : 2,
    "March" : 3,
    "April" : 4,
    "May" : 5,
    "June" : 6,
    "July" : 7,
    "August" : 8,
    "September" : 9,
    "October" : 10,
    "November" : 11,
    "December" : 12
  }

  //dictionary for number of days in month
  var monthMaxDayDict = {
    "January": 31,
    "February": 28,
    "March" : 31,
    "April" : 30,
    "May" : 31,
    "June" : 30,
    "July" : 31,
    "August" : 31,
    "September" : 30,
    "October" : 31,
    "November" : 30,
    "December" : 31
  }

  var yearSelectLabel = d3.select('body')
    .append('label')
    .attr('class', 'select-label')
    .attr('for', 'year')
    .text('Year:')

  //year drop down
  var yearSelect = d3.select('body')
    .append('select')
      .attr('class','select')
      .attr('id', 'year')
      .on('change',onchange)

  var options = yearSelect
    .selectAll('option')
    .data(years).enter()
    .append('option')
      .text(function (d) { return d; });

  var monthSelectLabel = d3.select('body')
    .append('label')
    .attr('class', 'select-label')
    .attr('for', 'month')
    .text('Month:')

  //month drop down
  var monthSelect = d3.select('body')
    .append('select')
      .attr('class','select')
      .attr('id', 'month')
      .attr('disabled', 'disabled')
      .on('change',onchange)

  var options = monthSelect
    .selectAll('option')
    .data(months).enter()
    .append('option')
    .text(function (d) { return d; });

  var daySelectLabel = d3.select('body')
    .append('label')
    .attr('class', 'select-label')
    .attr('for', 'day')
    .text('Day:')

  //day drop down
  var daySelect = d3.select('body')
    .append('select')
    .attr('class','select')
    .attr('id', 'day')
    .attr('disabled', 'disabled')
    .on('change',onchange)




  var options = daySelect
    .selectAll('option')
    .data(days).enter()
    .append('option')
    .text(function (d) { return d; });


  //function for when drop down is changed
  function onchange() {
    selectYear = d3.select("#year").property("value");
    selectMonth = d3.select("#month").property("value");
    selectDay = d3.select("#day").property("value");
    console.log(selectMonth);
    console.log(selectDay);

    if(infowindow)
    {
      infowindow.close();
    }
    

  // if(selectYear == "2014")
  // {
  //   newMonths14 = ["All", "July", "August", "September", "October", "November", "December"];

  //  monthSelect.selectAll('option').remove()
  //  monthSelect.selectAll('option').data(newMonths14).enter().append('option').text(function (d) { return d; });
  //  d3.select("#month").property("value", selectMonth);
  // }

  // if(selectYear == "2017")
  // {
  //   newMonths17 = ["All", "January", "February", "March", "April", "May", "June"];

  //  monthSelect.selectAll('option').remove()
  //  monthSelect.selectAll('option').data(newMonths17).enter().append('option').text(function (d) { return d; });
  //  d3.select("#month").property("value", selectMonth);
  // }

    //if month is all, month and day is null, disable day drop down
    if(selectYear == "All"){
      selectYear = null;
      selectMonth = null;
      selectDay = null;
      d3.select("#day").attr('disabled', 'disabled').property('value', 'All');
      d3.select("#month").attr('disabled', 'disabled').property('value', 'All');
    }
    else if(selectMonth == "All")
    {
      selectMonth = null;
      selectDay = null;
      d3.select("#day").attr('disabled', 'disabled').property('value', 'All');
      d3.select("#month").attr('disabled', null);

    }
    //else month is selected, enable day drop down
    else
    {
      d3.select("#day").attr('disabled', null);
      d3.select("#month").attr('disabled', null);

        var newDays = ["All"];
        //push number of days to newDays array, depending on month
        for(var i = 1; i <= monthMaxDayDict[selectMonth]; i++)
        {
          newDays.push(i);
        }
        //change spelt out month with corresponding number
        selectMonth = monthDict[selectMonth];

        //remove previous options
        daySelect.selectAll('option').remove()
        //replace new options
        daySelect.selectAll('option').data(newDays).enter().append('option').text(function (d) { return d; });
        //select day
        d3.select("#day").property("value", selectDay);
    }
    //if select day is all,
    if(selectDay == "All")
    {
      selectDay = null;
    }



    buildHeatmap(selectYear,selectMonth, selectDay);
  };







  // function to find key in array, give correct fill color
  function fillColor(lotCount, lotName, year, month=null, day=null)
  {

    total = 0;
    for(i = 0; i < lotCount.length; i++)
    { 
      if(lotCount[i].key == lotName) 
      {
        for(j = 0; j < lotCount[i].values.length; j++)
          {
              if(year == null){
                  total += lotCount[i].values[j].value;
              }
              else if(year == lotCount[i].values[j].key)
              {
                  if(month != null)
                  {
                      for(k = 0; k < lotCount[i].values[j].values.length; k++)
                      {
                          if (month == lotCount[i].values[j].values[k].key)
                          {
                             if(day != null)
                             {
                                for(l = 0; l < lotCount[i].values[j].values[k].values.length; l++)
                                {
                                  if (day == lotCount[i].values[j].values[k].values[l].key)
                                  {
                                  total += lotCount[i].values[j].values[k].values[l].value;
                                  }
                                }
                             }  
                             else 
                             {
                               total = lotCount[i].values[j].values[k].value;
                             }
                          }
                      }
                  }
                  else 
                  {
                    total = lotCount[i].values[j].value;
                  }
              } 
          } 
      }
    }
    // console.log(total);
    return total;
  }

  var infowindow = new google.maps.InfoWindow({
    content: ''
  });


  function maxGradient(lotCount, year, month, day)
  {
    

    currentMax = 0;
    for(i = 0; i < lotCount.length; i++)
    { 
      if(year == null) {
         if(lotCount[i].value > currentMax)
                    {
                      currentMax = lotCount[i].value;
                    }
      }
      else {
        for(j = 0; j < lotCount[i].values.length; j++)
          {
              if(year == lotCount[i].values[j].key)
              {
                  if(month != null)
                  {
                      for(k = 0; k < lotCount[i].values[j].values.length; k++)
                      {
                          if (month == lotCount[i].values[j].values[k].key)
                          {
                             if(day != null)
                             {
                                for(l = 0; l < lotCount[i].values[j].values[k].values.length; l++)
                                {
                                  if (day == lotCount[i].values[j].values[k].values[l].key)
                                  {
                                    if(lotCount[i].values[j].values[k].values[l].value > currentMax)
                                    {
                                      currentMax = lotCount[i].values[j].values[k].values[l].value;
                                    }

                                  }
                                }
                             }  
                             else 
                             {
                               if(lotCount[i].values[j].values[k].value > currentMax)
                               {
                                currentMax = lotCount[i].values[j].values[k].value;
                               }
                             }
                          }
                      }
                  }
              else 
              {
                    if(lotCount[i].values[j].value > currentMax)
                    {
                      currentMax = lotCount[i].values[j].value
                    }         
                  } 
              } 
      }
    }
  }
    console.log(currentMax);
    return currentMax;

  }

  function buildLegend(max, newgradient)
  {
    //clear old legend
    d3.select('svg').remove();
    d3.selectAll('.legend-keys').remove();

    d3.select('body').append('text').attr('class', 'legend-keys').text('0');
    d3.select('body').append('svg');

    var vis = d3.select('svg')
     
    vis
    .attr('height', 40)
    //var colorScale = newgradient;
     var colorScale = d3.scaleLinear().domain([0, 25, 50, 75, 100])
       .range(["light blue", "cyan", "green", "yellow", "red"])
    var xScale = d3.scaleLinear().domain([0, 100]).range([0, 300])

    var arr = d3.range(101);
    vis.selectAll('rect').data(arr).enter()
    .append('rect')
    .attr('x', function(d) { return xScale(d) })
          .attr('y', 20)
          .attr('height', 20)
          .attr('width', 5)
          .attr('fill', function(d) { return colorScale(d) })

      d3.select('body').append('text').attr('class','legend-keys').text(max);
  }



  //function to get rid of precious polygons and then add new ones
   function buildHeatmap(year=null, month=null, day=null){
    //Did they select a year only?
    yearOnly = month == null && day == null;
    //did they select a year and a month?
    yearAndMonth = day == null;

      maxGradient1 = maxGradient(year == null ? lotsRolledUp : (yearOnly?lotsRolledUpY:(yearAndMonth?lotsRolledUpM:lotsRolledUpD)), year, month, day);
    
    buildLegend(maxGradient1, gradient);

    //need function to find highest number 
  var gradient = d3.scaleLinear().domain([0, maxGradient1 * 0.25, maxGradient1 * 0.50, maxGradient1 * 0.75, maxGradient1]).range(["LIGHT BLUE", "CYAN", "GREEN", "YELLOW", "RED"]);




    //clear polygons
    for(var i = 0; i < existingPolygons.length; i++){
        existingPolygons[i].setMap(null);
    }


  jacksonAvePoly = new google.maps.Polygon({
    paths: window.LatLng.jacksonAveLatLng,
    fillColor: gradient(fillColor(yearOnly?lotsRolledUpY:(yearAndMonth?lotsRolledUpM:lotsRolledUpD), "JACKSON AVENUE CENTER", year, month, day)),
    fillOpacity: 0.95,
    strokeWeight: 0.6
  });

    sororityPoly = new google.maps.Polygon({
    paths: window.LatLng.sororityLatLng,
    fillColor: gradient(fillColor(yearOnly?lotsRolledUpY:(yearAndMonth?lotsRolledUpM:lotsRolledUpD), "SORORITY LOT", year, month, day)),
    fillOpacity: 0.95,
    strokeWeight: 0.6
   });

    coliseumEastPoly = new google.maps.Polygon({
    paths: window.LatLng.coliseumEastLatLng,
    fillColor: gradient(fillColor(yearOnly?lotsRolledUpY:(yearAndMonth?lotsRolledUpM:lotsRolledUpD), "COLISEUM EAST LOT", year, month, day)),
    fillOpacity: 0.95,
    strokeWeight: 0.6
   });

    crosbyRearPoly = new google.maps.Polygon({
    paths: window.LatLng.crosbyRearLatLng,
    fillColor: gradient(fillColor(yearOnly?lotsRolledUpY:(yearAndMonth?lotsRolledUpM:lotsRolledUpD), "CROSBY REAR LOT", year, month, day)),
    fillOpacity: 0.95,
    strokeWeight: 0.6
  });

    manningCenterPoly = new google.maps.Polygon({
    paths: window.LatLng.manningCenterLatLng,
    fillColor: gradient(fillColor(yearOnly?lotsRolledUpY:(yearAndMonth?lotsRolledUpM:lotsRolledUpD), "MANNING CENTER EAST", year, month, day)),
    fillOpacity: 0.95,
    strokeWeight: 0.6
  });

    residentialCollegePoly = new google.maps.Polygon({
    paths: window.LatLng.residentialCollegeLatLng,
    fillColor: gradient(fillColor(yearOnly?lotsRolledUpY:(yearAndMonth?lotsRolledUpM:lotsRolledUpD), "RESIDENTIAL COLLEGE/ALUMN DR LOT", year, month, day)),
    fillOpacity: 0.95,
    strokeWeight: 0.6
  });

    magnoliaPoly = new google.maps.Polygon({
    paths: window.LatLng.magnoliaLatLng,
    fillColor: gradient(fillColor(yearOnly?lotsRolledUpY:(yearAndMonth?lotsRolledUpM:lotsRolledUpD), "MAGNOLIA DRIVE", year, month, day)),
    fillOpacity: 0.95,
    strokeWeight: 0.6
  });

    meekPoly = new google.maps.Polygon({
    paths: window.LatLng.meekLatLng,
    fillColor: gradient(fillColor(yearOnly?lotsRolledUpY:(yearAndMonth?lotsRolledUpM:lotsRolledUpD), "MEEK LOT", year, month, day)),
    fillOpacity: 0.95,
    strokeWeight: 0.6
  });

    bishopPoly = new google.maps.Polygon({
    paths: window.LatLng.bishopLatLng,
    fillColor: gradient(fillColor(yearOnly?lotsRolledUpY:(yearAndMonth?lotsRolledUpM:lotsRolledUpD), "BISHOP LOT", year, month, day)),
    fillOpacity: 0.95,
    strokeWeight: 0.6
  });

    fordCenterPoly = new google.maps.Polygon({
    paths: window.LatLng.fordCenterLatLng,
    fillColor: gradient(fillColor(yearOnly?lotsRolledUpY:(yearAndMonth?lotsRolledUpM:lotsRolledUpD), "FORD CENTER LOT", year, month, day)),
    fillOpacity: 0.95,
    strokeWeight: 0.6
  });

  circlePoly = new google.maps.Polygon({
    paths: [window.LatLng.outerCircleLatLng, window.LatLng.innerCircleLatLng],
    fillColor: gradient(fillColor(yearOnly?lotsRolledUpY:(yearAndMonth?lotsRolledUpM:lotsRolledUpD), "CIRCLE", year, month, day)),
    fillOpacity: 0.95,
    strokeWeight: 0.6
  });

  stockardRearPoly = new google.maps.Polygon({
    paths: window.LatLng.stockardRearLatLng,
    fillColor: gradient(fillColor(yearOnly?lotsRolledUpY:(yearAndMonth?lotsRolledUpM:lotsRolledUpD), "STOCKARD REAR LOT", year, month, day)),
    fillOpacity: 0.95,
    strokeWeight: 0.6,
  });

  oldAthleticsPoly = new google.maps.Polygon({
    paths: window.LatLng.oldAthleticsLatLng,
    fillColor: gradient(fillColor(yearOnly?lotsRolledUpY:(yearAndMonth?lotsRolledUpM:lotsRolledUpD), "OLD ATHLETICS F/S", year, month, day)),
    fillOpacity: 0.95,
    strokeWeight: 0.6
  });

  kincannonPoly = new google.maps.Polygon({
    paths: window.LatLng.kincannonLatLng,
    fillColor: gradient(fillColor(yearOnly?lotsRolledUpY:(yearAndMonth?lotsRolledUpM:lotsRolledUpD), "KINCANNON  HALL PARKING LOT", year, month, day)),
    fillOpacity: 0.95,
    strokeWeight: 0.6
  });

  womensTerraceLowerPoly = new google.maps.Polygon({
    paths: window.LatLng.womensTerraceLowerLatLng,
    fillColor: gradient(fillColor(yearOnly?lotsRolledUpY:(yearAndMonth?lotsRolledUpM:lotsRolledUpD), "WOMENS TERRACE-LOWER LOT", year, month, day)),
    fillOpacity: 0.95,
    strokeWeight: 0.6
  });

  hflFacultyPoly = new google.maps.Polygon({
    paths: window.LatLng.hflFacultyLatLng,
    fillColor: gradient(fillColor(yearOnly?lotsRolledUpY:(yearAndMonth?lotsRolledUpM:lotsRolledUpD), "HFL FACULTY/STAFF", year, month, day)),
    fillOpacity: 0.95,
    strokeWeight: 0.6
  });

  oldAthleticMeterPoly = new google.maps.Polygon({
    paths: window.LatLng.oldAthleticMeterLatLng,
    fillColor: gradient(fillColor(yearOnly?lotsRolledUpY:(yearAndMonth?lotsRolledUpM:lotsRolledUpD), "OLD ATHLETICS METER", year, month, day)),
    fillOpacity: 0.95,
    strokeWeight: 0.6
  });


  dormRowNorthPoly = new google.maps.Polygon({
    paths: [window.LatLng.dormRowNorthLatLng1, window.LatLng.dormRowNorthLatLng2, window.LatLng.dormRowNorthLatLng3],
    fillColor: gradient(fillColor(yearOnly?lotsRolledUpY:(yearAndMonth?lotsRolledUpM:lotsRolledUpD), "DORM ROW NORTH", year, month, day)),
    fillOpacity: 0.95,
    strokeWeight: 0.6
  });

  campusWalkPoly = new google.maps.Polygon({
    paths: [window.LatLng.campusWalkLatLng, window.LatLng.campusWalkHoleLatLng1, window.LatLng.campusWalkHoleLatLng2, window.LatLng.campusWalkHoleLatLng3, window.LatLng.campusWalkHoleLatLng4, window.LatLng.campusWalkHoleLatLng5],
     fillColor: gradient(fillColor(yearOnly?lotsRolledUpY:(yearAndMonth?lotsRolledUpM:lotsRolledUpD), "CAMPUS WALK APT. COMPLEX", year, month, day)),
    fillOpacity: 0.95,
    strokeWeight: 0.6
  });

  ncpaFacultyPoly = new google.maps.Polygon({
    paths: window.LatLng.ncpaFacultyLatLng,
     fillColor: gradient(fillColor(yearOnly?lotsRolledUpY:(yearAndMonth?lotsRolledUpM:lotsRolledUpD), "NCPA FACULTY/STAFF LOT", year, month, day)),
    fillOpacity: 0.95,
    strokeWeight: 0.6
  });

  allAmericanPoly = new google.maps.Polygon({
    paths: window.LatLng.allAmericanLatLng,
     fillColor: gradient(fillColor(yearOnly?lotsRolledUpY:(yearAndMonth?lotsRolledUpM:lotsRolledUpD), "ALL AMERICAN DR.", year, month, day)),
    fillOpacity: 0.95,
    strokeWeight: 0.6
  });

  coliseumWestPoly = new google.maps.Polygon({
    paths: [window.LatLng.coliseumWestLatLng1, window.LatLng.coliseumWestLatLng2, window.LatLng.coliseumWestLatLng3, window.LatLng.coliseumWestLatLng4],
     fillColor: gradient(fillColor(yearOnly?lotsRolledUpY:(yearAndMonth?lotsRolledUpM:lotsRolledUpD), "COLISEUM WEST LOT", year, month, day)),
    fillOpacity: 0.95,
    strokeWeight: 0.6
  });

  womensTerraceUpperPoly = new google.maps.Polygon({
    paths: window.LatLng.womensTerraceUpperLatLng,
     fillColor: gradient(fillColor(yearOnly?lotsRolledUpY:(yearAndMonth?lotsRolledUpM:lotsRolledUpD), "WOMENS TERRACE-UPPER LOT", year, month, day)),
    fillOpacity: 0.95,
    strokeWeight: 0.6
  });

  turnerColiseumPoly = new google.maps.Polygon({
    paths: window.LatLng.turnerColiseumLatLng,
     fillColor: gradient(fillColor(yearOnly?lotsRolledUpY:(yearAndMonth?lotsRolledUpM:lotsRolledUpD), "TURNER COLISEUM LOT", year, month, day)),
    fillOpacity: 0.95,
    strokeWeight: 0.6
  });




  lotAndLatLngDict = {
    "JACKSON AVENUE CENTER" : new google.maps.LatLng(34.370165509648004, -89.54679988324642),
    "SORORITY LOT" : new google.maps.LatLng(34.36882829393721, -89.53233204782009),
    "COLISEUM EAST LOT" : new google.maps.LatLng(34.3630851082921, -89.53932724893093),
    "CROSBY REAR LOT" : new google.maps.LatLng(34.37094037653353, -89.53470848500729),
    "MANNING CENTER EAST" : new google.maps.LatLng(34.360136476997866, -89.53510444611311),
    "RESIDENTIAL COLLEGE/ALUMN DR LOT" : new google.maps.LatLng(34.36774355472055, -89.5295150578022),
    "MAGNOLIA DRIVE" : new google.maps.LatLng(34.365969031253414, -89.54126983880997),
    "MEEK LOT" : new google.maps.LatLng(34.36706939521034, -89.5372948050499),
    "BISHOP LOT" : new google.maps.LatLng(34.36535352961884, -89.53970611095428),
    "FORD CENTER LOT" : new google.maps.LatLng(34.36639855129822, -89.52810287475586),
    "CIRCLE" : new google.maps.LatLng(34.36523839931469, -89.53577399253845),
    "STOCKARD REAR LOT" : new google.maps.LatLng(34.36999846262895, -89.53721702098846),
    "OLD ATHLETICS F/S" : new google.maps.LatLng(34.36354685122506, -89.53876733779907),
    "KINCANNON  HALL PARKING LOT" : new google.maps.LatLng(34.369044257656945, -89.53848972916603),
    "WOMENS TERRACE-LOWER LOT" : new google.maps.LatLng(34.368542797555165, -89.53473530709743),
    "HFL FACULTY/STAFF" : new google.maps.LatLng(34.3667395089413, -89.5380511879921),
    "OLD ATHLETICS METER" : new google.maps.LatLng(34.36394095841237, -89.53817456960678),
    "DORM ROW NORTH" : new google.maps.LatLng(34.36702511524971, -89.5376904308796),
    "CAMPUS WALK APT. COMPLEX" : new google.maps.LatLng(34.364366060716115, -89.54769641160965),
    "NCPA FACULTY/STAFF LOT" : new google.maps.LatLng(34.36149657831279, -89.54106599092484),
    "ALL AMERICAN DR." : new google.maps.LatLng(34.364382666231094, -89.53818965703249),
    "COLISEUM WEST LOT" : new google.maps.LatLng(34.363375037542795, -89.54072856955463),
    "WOMENS TERRACE-UPPER LOT" : new google.maps.LatLng(34.368250923426345, -89.53442215919495),
    "TURNER COLISEUM LOT" : new google.maps.LatLng()
  }//need to adjust loc from col west and up



  function addInfoWindow(lotName) {
      if(infowindow)
      {
        infowindow.close();
      }

      infowindow.setContent("<div id='iw-container'>" 
        + "<div id='iw-title'>"
        + "<span class='lot-name'>" + lotName + "</span>" 
        + "</div>" 
        + "<div id='iw-content'>Number of Tickets: " + fillColor(yearOnly?lotsRolledUpY:(yearAndMonth?lotsRolledUpM:lotsRolledUpD), lotName, year, month, day) + "</div></div>");






      infowindow.setPosition(lotAndLatLngDict[lotName]);

      infowindow.open(map);
  }


  //Info Window event listeners, every polygon
  google.maps.event.addListener(jacksonAvePoly, 'mouseover', function() {
  addInfoWindow("JACKSON AVENUE CENTER");
  this.setOptions({strokeWeight: 1.6});
  });

  // google.maps.event.addListener(jacksonAvePoly,"mouseout",function(){
  //   timeoutId = window.setTimeout(function() {
  //      if(infowindow) {
  //       infowindow.close();
  //      }
  //    }, 2000);
  // });

  google.maps.event.addListener(jacksonAvePoly, 'mouseout', function() {
  this.setOptions({strokeWeight: 0.6});
  });

  google.maps.event.addListener(sororityPoly, 'mouseover', function() {
  addInfoWindow("SORORITY LOT");
  this.setOptions({strokeWeight: 1.6});
  });
  google.maps.event.addListener(sororityPoly, 'mouseout', function() {
  this.setOptions({strokeWeight: 0.6});
  });

  google.maps.event.addListener(coliseumEastPoly, 'mouseover', function() {
  addInfoWindow("COLISEUM EAST LOT");
  this.setOptions({strokeWeight: 1.6});
  });
  google.maps.event.addListener(coliseumEastPoly, 'mouseout', function() {
  this.setOptions({strokeWeight: 0.6});
  });

  google.maps.event.addListener(crosbyRearPoly, 'mouseover', function() {
  addInfoWindow("CROSBY REAR LOT");
  this.setOptions({strokeWeight: 1.6});
  });
  google.maps.event.addListener(crosbyRearPoly, 'mouseout', function() {
  this.setOptions({strokeWeight: 0.6});
  });

  google.maps.event.addListener(manningCenterPoly, 'mouseover', function() {
    addInfoWindow("MANNING CENTER EAST");
    this.setOptions({strokeWeight: 1.6});
  })
  google.maps.event.addListener(manningCenterPoly, 'mouseout', function() {
  this.setOptions({strokeWeight: 0.6});
  });

  google.maps.event.addListener(residentialCollegePoly, 'mouseover', function() {
    addInfoWindow("RESIDENTIAL COLLEGE/ALUMN DR LOT");
    this.setOptions({strokeWeight: 1.6});
  })
  google.maps.event.addListener(residentialCollegePoly, 'mouseout', function() {
  this.setOptions({strokeWeight: 0.6});
  });

  google.maps.event.addListener(magnoliaPoly, 'mouseover', function() {
    addInfoWindow("MAGNOLIA DRIVE");
    this.setOptions({strokeWeight: 1.6});
  })
  google.maps.event.addListener(magnoliaPoly, 'mouseout', function() {
  this.setOptions({strokeWeight: 0.6});
  });

  google.maps.event.addListener(meekPoly, 'mouseover', function() {
    addInfoWindow("MEEK LOT");
    this.setOptions({strokeWeight: 1.6});
  })
  google.maps.event.addListener(meekPoly, 'mouseout', function() {
  this.setOptions({strokeWeight: 0.6});
  });

  google.maps.event.addListener(bishopPoly, 'mouseover', function() {
    addInfoWindow("BISHOP LOT");
    this.setOptions({strokeWeight: 1.6});
  })
  google.maps.event.addListener(bishopPoly, 'mouseout', function() {
  this.setOptions({strokeWeight: 0.6});
  });

  google.maps.event.addListener(fordCenterPoly, 'mouseover', function() {
    addInfoWindow("FORD CENTER LOT");
    this.setOptions({strokeWeight: 1.6});
  })
  google.maps.event.addListener(fordCenterPoly, 'mouseout', function() {
  this.setOptions({strokeWeight: 0.6});
  });

  google.maps.event.addListener(circlePoly, 'mouseover', function() {
    addInfoWindow("CIRCLE");
    this.setOptions({strokeWeight: 1.6});
  })

  google.maps.event.addListener(circlePoly, 'mouseout', function() {
  this.setOptions({strokeWeight: 0.6});
  });

  google.maps.event.addListener(stockardRearPoly, 'mouseover', function() {
    addInfoWindow("STOCKARD REAR LOT");
    this.setOptions({strokeWeight: 1.6});
  })
  google.maps.event.addListener(stockardRearPoly, 'mouseout', function() {
  this.setOptions({strokeWeight: 0.6});
  });

  google.maps.event.addListener(oldAthleticsPoly, 'mouseover', function() {
    addInfoWindow("OLD ATHLETICS F/S");
    this.setOptions({strokeWeight: 1.6});
  })
  google.maps.event.addListener(oldAthleticsPoly, 'mouseout', function() {
  this.setOptions({strokeWeight: 0.6});
  });

  google.maps.event.addListener(kincannonPoly, 'mouseover', function() {
    addInfoWindow("KINCANNON  HALL PARKING LOT");
    this.setOptions({strokeWeight: 1.6});
  })
  google.maps.event.addListener(kincannonPoly, 'mouseout', function() {
  this.setOptions({strokeWeight: 0.6});
  });

  google.maps.event.addListener(womensTerraceLowerPoly, 'mouseover', function() {
    addInfoWindow("WOMENS TERRACE-LOWER LOT");
    this.setOptions({strokeWeight: 1.6});
  })
  google.maps.event.addListener(womensTerraceLowerPoly, 'mouseout', function() {
  this.setOptions({strokeWeight: 0.6});
  });

  google.maps.event.addListener(hflFacultyPoly, 'mouseover', function() {
    addInfoWindow("HFL FACULTY/STAFF");
    this.setOptions({strokeWeight: 1.6});
  })

  google.maps.event.addListener(hflFacultyPoly, 'mouseout', function() {
  this.setOptions({strokeWeight: 0.6});
  });

  google.maps.event.addListener(oldAthleticMeterPoly, 'mouseover', function() {
    addInfoWindow("OLD ATHLETICS METER");
    this.setOptions({strokeWeight: 1.6});
  })
  google.maps.event.addListener(oldAthleticMeterPoly, 'mouseout', function() {
  this.setOptions({strokeWeight: 0.6});
  });

  google.maps.event.addListener(dormRowNorthPoly, 'mouseover', function() {
  addInfoWindow("DORM ROW NORTH");
  this.setOptions({strokeWeight: 1.6});
  });
  google.maps.event.addListener(dormRowNorthPoly, 'mouseout', function() {
  this.setOptions({strokeWeight: 0.6});
  });

  google.maps.event.addListener(campusWalkPoly, 'mouseover', function() {
  addInfoWindow("CAMPUS WALK APT. COMPLEX");
  this.setOptions({strokeWeight: 1.6});
  });
  google.maps.event.addListener(campusWalkPoly, 'mouseout', function() {
  this.setOptions({strokeWeight: 0.6});
  });

  google.maps.event.addListener(ncpaFacultyPoly, 'mouseover', function() {
  addInfoWindow("NCPA FACULTY/STAFF LOT");
  this.setOptions({strokeWeight: 1.6});
  });
  google.maps.event.addListener(ncpaFacultyPoly, 'mouseout', function() {
  this.setOptions({strokeWeight: 0.6});
  });

  google.maps.event.addListener(allAmericanPoly, 'mouseover', function() {
  addInfoWindow("ALL AMERICAN DR.");
  this.setOptions({strokeWeight: 1.6});
  });
  google.maps.event.addListener(allAmericanPoly, 'mouseout', function() {
  this.setOptions({strokeWeight: 0.6});
  });

  google.maps.event.addListener(coliseumWestPoly, 'mouseover', function() {
  addInfoWindow("COLISEUM WEST LOT");
  this.setOptions({strokeWeight: 1.6});
  });
  google.maps.event.addListener(coliseumWestPoly, 'mouseout', function() {
  this.setOptions({strokeWeight: 0.6});
  });

  google.maps.event.addListener(womensTerraceUpperPoly, 'mouseover', function() {
  addInfoWindow("WOMENS TERRACE-UPPER LOT");
  this.setOptions({strokeWeight: 1.6});
  });
  google.maps.event.addListener(womensTerraceUpperPoly, 'mouseout', function() {
  this.setOptions({strokeWeight: 0.6});
  });

  google.maps.event.addListener(turnerColiseumPoly, 'mouseover', function() {
  addInfoWindow("TURNER COLISEUM LOT");
  this.setOptions({strokeWeight: 1.6});
  });
  google.maps.event.addListener(turnerColiseumPoly, 'mouseout', function() {
  this.setOptions({strokeWeight: 0.6});
  });




  //push polygons to existing polygon array
  existingPolygons.push(jacksonAvePoly);
  existingPolygons.push(sororityPoly);
  existingPolygons.push(coliseumEastPoly);
  existingPolygons.push(crosbyRearPoly);
  existingPolygons.push(manningCenterPoly);

  existingPolygons.push(residentialCollegePoly);
  existingPolygons.push(magnoliaPoly);
  existingPolygons.push(meekPoly);
  existingPolygons.push(bishopPoly);
  existingPolygons.push(fordCenterPoly);

  existingPolygons.push(circlePoly);
  existingPolygons.push(stockardRearPoly);
  existingPolygons.push(oldAthleticsPoly);
  existingPolygons.push(kincannonPoly);
  existingPolygons.push(womensTerraceLowerPoly);

  existingPolygons.push(hflFacultyPoly);
  existingPolygons.push(oldAthleticMeterPoly);
  existingPolygons.push(dormRowNorthPoly);
  existingPolygons.push(campusWalkPoly);
  existingPolygons.push(ncpaFacultyPoly);

  existingPolygons.push(allAmericanPoly);
  existingPolygons.push(coliseumWestPoly);
  existingPolygons.push(womensTerraceUpperPoly);
  existingPolygons.push(turnerColiseumPoly);

  //bind polygons to map
  jacksonAvePoly.setMap(map);
  sororityPoly.setMap(map);
  coliseumEastPoly.setMap(map);
  crosbyRearPoly.setMap(map);
  manningCenterPoly.setMap(map);

  residentialCollegePoly.setMap(map);
  magnoliaPoly.setMap(map);
  meekPoly.setMap(map);
  bishopPoly.setMap(map);
  fordCenterPoly.setMap(map);

  circlePoly.setMap(map);
  stockardRearPoly.setMap(map);
  oldAthleticsPoly.setMap(map);
  kincannonPoly.setMap(map);
  womensTerraceLowerPoly.setMap(map);

  hflFacultyPoly.setMap(map);
  oldAthleticMeterPoly.setMap(map);
  dormRowNorthPoly.setMap(map);
  campusWalkPoly.setMap(map);
  ncpaFacultyPoly.setMap(map);

  allAmericanPoly.setMap(map);
  coliseumWestPoly.setMap(map);
  womensTerraceUpperPoly.setMap(map);
  turnerColiseumPoly.setMap(map);
  }













  // //Poole Drive #8 Lot
  // pooleDriveLatLng =[
  // {"lat":  34.3642780514318, "lng": -89.5434394106268},
  // {"lat":  34.3642680881108, "lng": -89.5434273406863},
  // {"lat":  34.3642680881108, "lng": -89.5434270054101},
  // {"lat":  34.364253696645, "lng": -89.5434259995818},
  // {"lat":  34.3642398586947, "lng": -89.5434280112385},
  // {"lat":  34.3642265742604, "lng": -89.5434340462088},
  // {"lat":  34.3642265742604, "lng": -89.5434337109327},
  // {"lat":  34.3642155038968, "lng": -89.543421305716},
  // {"lat":  34.364201112422, "lng": -89.5433616265654},
  // {"lat":  34.3641507422406, "lng": -89.5431819185614},
  // {"lat":  34.3640632862494, "lng": -89.5428741350769},
  // {"lat":  34.363972509048, "lng": -89.5425864681601},
  // {"lat":  34.3638955697577, "lng": -89.5423028245568},
  // {"lat":  34.3639437260124, "lng": -89.5422880724072},
  // {"lat":  34.3639321020914, "lng": -89.5422411337494},
  // {"lat":  34.3639237992897, "lng": -89.5422230288386},
  // {"lat":  34.3639071936838, "lng": -89.542210958898},
  // {"lat":  34.3638922486356, "lng": -89.5421968773007},
  // {"lat":  34.3638568233257, "lng": -89.5420869067311},
  // {"lat":  34.3638579303669, "lng": -89.5420614257454},
  // {"lat":  34.3638629120519, "lng": -89.5420265570282},
  // {"lat":  34.3638490740372, "lng": -89.5419930294156},
  // {"lat":  34.3638125416673, "lng": -89.5420044288039},
  // {"lat":  34.3638058994165, "lng": -89.5419910177588},
  // {"lat":  34.3637760092814, "lng": -89.5418763533234},
  // {"lat":  34.3637389233583, "lng": -89.5417281612753},
  // {"lat":  34.3636918740292, "lng": -89.5415417477488},
  // {"lat":  34.3636874458557, "lng": -89.5415202900767},
  // {"lat":  34.3637367092728, "lng": -89.5415001735091},
  // {"lat":  34.3637234247586, "lng": -89.5414666458964},
  // {"lat":  34.3637123543286, "lng": -89.5414592698216},
  // {"lat":  34.3636963022024, "lng": -89.54135466367},
  // {"lat":  34.363706819113, "lng": -89.5413338765501},
  // {"lat":  34.3637095867209, "lng": -89.5413191244006},
  // {"lat":  34.3637079261562, "lng": -89.5413083955645},
  // {"lat":  34.3637001768539, "lng": -89.5412983372807},
  // {"lat":  34.3636857852905, "lng": -89.5412929728627},
  // {"lat":  34.3636514669372, "lng": -89.5413023605942},
  // {"lat":  34.3635828301884, "lng": -89.5409201458096},
  // {"lat":  34.3635634569024, "lng": -89.5407940819859},
  // {"lat":  34.3635540470189, "lng": -89.5407464727759},
  // {"lat":  34.3635905795016, "lng": -89.5407303795218},
  // {"lat":  34.3635927935909, "lng": -89.5406995341181},
  // {"lat":  34.3635927935909, "lng": -89.540699198842},
  // {"lat":  34.3635728667847, "lng": -89.5406820997595},
  // {"lat":  34.3635523864512, "lng": -89.5405587181448},
  // {"lat":  34.363559028722, "lng": -89.5405312255024},
  // {"lat":  34.3635640104249, "lng": -89.5405137911438},
  // {"lat":  34.3635640104249, "lng": -89.5405134558677},
  // {"lat":  34.3635529399738, "lng": -89.540498368442},
  // {"lat":  34.3635407624759, "lng": -89.540498368442},
  // {"lat":  34.3635407624759, "lng": -89.5404980331659},
  // {"lat":  34.3635075511089, "lng": -89.5405057445168},
  // {"lat":  34.3634914989435, "lng": -89.5403997972607},
  // {"lat":  34.3634870707594, "lng": -89.5403622463345},
  // {"lat":  34.3634854101903, "lng": -89.54031329602},
  // {"lat":  34.3634837496212, "lng": -89.5402811095118},
  // {"lat":  34.3634798749597, "lng": -89.5401959493756},
  // {"lat":  34.3634826425751, "lng": -89.5401409640908},
  // {"lat":  34.3634793214367, "lng": -89.5401114597916},
  // {"lat":  34.3634809820059, "lng": -89.5400812849402},
  // {"lat":  34.3635047834944, "lng": -89.5400745794177},
  // {"lat":  34.3635291384989, "lng": -89.5400732383131},
  // {"lat":  34.3635346737262, "lng": -89.540051780641},
  // {"lat":  34.3635208356573, "lng": -89.5400115475058},
  // {"lat":  34.3635081046318, "lng": -89.5399921014904},
  // {"lat":  34.363536887817, "lng": -89.539872072637},
  // {"lat":  34.3635911330239, "lng": -89.5398237928748},
  // {"lat":  34.3636010964254, "lng": -89.5398090407252},
  // {"lat":  34.3635999893809, "lng": -89.5397942885756},
  // {"lat":  34.3635861513227, "lng": -89.5397835597395},
  // {"lat":  34.3635579216769, "lng": -89.5397708192467},
  // {"lat":  34.3635645639474, "lng": -89.539739973843},
  // {"lat":  34.3635689921274, "lng": -89.5397218689322},
  // {"lat":  34.3635789555315, "lng": -89.5396856591105},
  // {"lat":  34.3635855978003, "lng": -89.5396668836474},
  // {"lat":  34.3636027569922, "lng": -89.5396192744374},
  // {"lat":  34.3636232373135, "lng": -89.5395642891526},
  // {"lat":  34.3636276654904, "lng": -89.5395502075552},
  // {"lat":  34.363663644419, "lng": -89.5395777001976},
  // {"lat":  34.3636780359862, "lng": -89.539560265839},
  // {"lat":  34.363706819113, "lng": -89.5394697412848},
  // {"lat":  34.3637201036298, "lng": -89.5394268259406},
  // {"lat":  34.3636769289426, "lng": -89.5394040271639},
  // {"lat":  34.3637915078713, "lng": -89.5390519872307},
  // {"lat":  34.363826379688, "lng": -89.5389621332287},
  // {"lat":  34.3638568233257, "lng": -89.5388950780034},
  // {"lat":  34.3639193711284, "lng": -89.5388970896601},
  // {"lat":  34.3639952033576, "lng": -89.5388058945536},
  // {"lat":  34.3640859805344, "lng": -89.5387153699994},
  // {"lat":  34.3641540633524, "lng": -89.5386851951479},
  // {"lat":  34.3642226996333, "lng": -89.5386637374758},
  // {"lat":  34.364252589609, "lng": -89.538648314774},
  // {"lat":  34.3643228863618, "lng": -89.5386295393109},
  // {"lat":  34.3643477946458, "lng": -89.5386100932955},
  // {"lat":  34.3643577579574, "lng": -89.5386583730578},
  // {"lat":  34.3643660607161, "lng": -89.5387140288949},
  // {"lat":  34.3642664275571, "lng": -89.5387609675526},
  // {"lat":  34.3642066476049, "lng": -89.538777731359},
  // {"lat":  34.3641490816847, "lng": -89.5388005301356},
  // {"lat":  34.3641302620483, "lng": -89.5388126000761},
  // {"lat":  34.364095390358, "lng": -89.538833387196},
  // {"lat":  34.3640715890373, "lng": -89.5388494804501},
  // {"lat":  34.3640466806711, "lng": -89.5388736203312},
  // {"lat":  34.3640129159852, "lng": -89.5389111712574},
  // {"lat":  34.3639907752001, "lng": -89.5389373227953},
  // {"lat":  34.3639708484886, "lng": -89.5389802381396},
  // {"lat":  34.3639570104916, "lng": -89.5390057191252},
  // {"lat":  34.3639337626517, "lng": -89.5390687510371},
  // {"lat":  34.3639188176082, "lng": -89.5391210541129},
  // {"lat":  34.3638922486356, "lng": -89.5391921326518},
  // {"lat":  34.3638629120519, "lng": -89.539288021624},
  // {"lat":  34.3638407712272, "lng": -89.5393577590584},
  // {"lat":  34.3638285937711, "lng": -89.5393852517008},
  // {"lat":  34.3638025782909, "lng": -89.5394583418965},
  // {"lat":  34.3637594036462, "lng": -89.5395864173769},
  // {"lat":  34.3637189965868, "lng": -89.5396970584988},
  // {"lat":  34.3636929810725, "lng": -89.5397949591279},
  // {"lat":  34.3636708402029, "lng": -89.5398593321442},
  // {"lat":  34.3636542345468, "lng": -89.5399330928921},
  // {"lat":  34.363631540145, "lng": -89.5400397107005},
  // {"lat":  34.3636199161806, "lng": -89.5400484278798},
  // {"lat":  34.3636154880033, "lng": -89.5400591567158},
  // {"lat":  34.3636138274367, "lng": -89.5400873199105},
  // {"lat":  34.3636127203924, "lng": -89.5401858910918},
  // {"lat":  34.3636182556141, "lng": -89.5402381941676},
  // {"lat":  34.3636276654904, "lng": -89.5403951033949},
  // {"lat":  34.3636387359316, "lng": -89.5404695346951},
  // {"lat":  34.3636486993274, "lng": -89.5405419543385},
  // {"lat":  34.3636630908972, "lng": -89.5406063273549},
  // {"lat":  34.3636830176819, "lng": -89.5407223328948},
  // {"lat":  34.3637095867209, "lng": -89.5408685132861},
  // {"lat":  34.3637284064517, "lng": -89.5409550145268},
  // {"lat":  34.3637599571674, "lng": -89.541124664247},
  // {"lat":  34.3637693670277, "lng": -89.5411816611886},
  // {"lat":  34.3637843120978, "lng": -89.5412560924887},
  // {"lat":  34.3637898473082, "lng": -89.5413077250123},
  // {"lat":  34.3637975966022, "lng": -89.5413352176547},
  // {"lat":  34.3638191839175, "lng": -89.5415216311812},
  // {"lat":  34.3638319148957, "lng": -89.5415880158543},
  // {"lat":  34.363875089503, "lng": -89.5417576655745},
  // {"lat":  34.3639110683254, "lng": -89.541896469891},
  // {"lat":  34.3639387443322, "lng": -89.5420118048787},
  // {"lat":  34.3639669738496, "lng": -89.542115740478},
  // {"lat":  34.3639979709559, "lng": -89.5422223582863},
  // {"lat":  34.3640411454776, "lng": -89.5423732325434},
  // {"lat":  34.3640870875725, "lng": -89.5425334945321},
  // {"lat":  34.3641341366797, "lng": -89.5426964387297},
  // {"lat":  34.3641784181682, "lng": -89.5428473129868},
  // {"lat":  34.364196130757, "lng": -89.5429116860032},
  // {"lat":  34.3642249137059, "lng": -89.5430109277367},
  // {"lat":  34.3642603388602, "lng": -89.5431282743811},
  // {"lat":  34.3643112624933, "lng": -89.5432992652058},
  // {"lat":  34.3643378313331, "lng": -89.5433884486556},
  // {"lat":  34.3643428129896, "lng": -89.5434065535664},
  // {"lat":  34.3642758373605, "lng": -89.5434363931417},

  // ];

  // pooleDrivePoly = new google.maps.Polygon({
  //   paths: pooleDriveLatLng,
  //   strokeColor: '#FF0000',
  //   strokeOpacity: 0.8,
  //   strokeWeight: 0,
  //   fillColor: gradient(fillColor(lotCount, "POOLE DRIVE")),
  //   fillOpacity: 0.95
  // });





   //init with 2014
   buildHeatmap(d3.select("#year").property("value") == 'All' ? null : d3.select('#year').property('value'));
  });


  document.getElementById("myButton").onclick = function () {
          location.href = "lineGraph.html";
      };

  google.maps.event.addDomListener(window, 'resize', function() {
    map.setCenter(new google.maps.LatLng(34.364732, -89.538443));
  });

  </script>
  </div>
    </body>

  </html>



