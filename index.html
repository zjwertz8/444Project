

  <!DOCTYPE html>
  <html>
    <head>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Ole Miss Parking Citation Visualization</title>
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.6/css/bootstrap.min.css">
      <link rel="stylesheet" href="stylesheets/styles.css">
      <script src="http://maps.google.com/maps/api/js?sensor=True"></script>
    </head>
  <body>
  <h1><img height="80" width="115" src="OleMiss.png" alt="Ole Miss">Parking Citation Visualization </h1>

  <script type="text/javascript" src="d3.min.js"></script>
  <script type="text/javascript" src="d3/d3.min.js"></script>
  <script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>
  <script type="text/javascript" src="scripts/globalLatLng.js"></script>
  <div id="map-container">
  <div id="map"></div>
  <script>

  var map = new google.maps.Map(d3.select("#map").node(), {
                 zoom: 15,
                 center: new google.maps.LatLng(34.364732, -89.538443),
                 mapTypeId: google.maps.MapTypeId.ROADMAP
               });

  //array of existing polygons
  var existingPolygons = [];



  d3.csv("FullDataRaw.csv", function(data) {
   
    //rollup with parking lot
    var lotsRolledUp = d3.nest()
    .key(function(d) {return d.CLM_DESCRIPTION;})
    .rollup(function(v) {return v.length;})
    .entries(data)

    //rollup with parking lot and year
    var lotsRolledUpY = d3.nest()
    .key(function(d) {return d.CLM_DESCRIPTION;})
    .key(function(d) {return d.Year;})
    .rollup(function(v) {return v.length;})
    .entries(data)
    
    //rollup with parking lot and year and month
    var lotsRolledUpM = d3.nest()
    .key(function(d) {return d.CLM_DESCRIPTION;})
    .key(function(d) {return d.Year;})
    .key(function(d) {return d.Month;})
    .rollup(function(v) {return v.length;})
    .entries(data)

    //rollup with parking lot and year and month and day
    var lotsRolledUpD = d3.nest()
    .key(function(d) {return d.CLM_DESCRIPTION;})
    .key(function(d) {return d.Year;})
    .key(function(d) {return d.Month;})
    .key(function(d) {return d.Day;})
    .rollup(function(v) {return v.length;})
    .entries(data)

  console.log(lotsRolledUp);
  console.log(lotsRolledUpY);
  console.log(lotsRolledUpM);
  console.log(lotsRolledUpD);


  var years = ["All", "2014", "2015", "2016", "2017"];

  var months = ["All", "January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];
  var days = ["All"];

  //dictionary for corresponding month day
  var monthDict = {
    "January" : 1,
    "February" : 2,
    "March" : 3,
    "April" : 4,
    "May" : 5,
    "June" : 6,
    "July" : 7,
    "August" : 8,
    "September" : 9,
    "October" : 10,
    "November" : 11,
    "December" : 12
  }


  //dictionary for number of days in month
  var monthMaxDayDict = {
    "January": 31,
    "February": 28,
    "March" : 31,
    "April" : 30,
    "May" : 31,
    "June" : 30,
    "July" : 31,
    "August" : 31,
    "September" : 30,
    "October" : 31,
    "November" : 30,
    "December" : 31
  }
  
  //label for year
  var yearSelectLabel = d3.select('#map-container')
    .append('label')
    .attr('class', 'select-label')
    .attr('for', 'year')
    .text('Year:')

  //year drop down
  var yearSelect = d3.select('#map-container')
    .append('select')
      .attr('class','select')
      .attr('id', 'year')
      .on('change',onchange)

  var options = yearSelect
    .selectAll('option')
    .data(years).enter()
    .append('option')
      .text(function (d) { return d; });

  //label for month
  var monthSelectLabel = d3.select('#map-container')
    .append('label')
    .attr('class', 'select-label')
    .attr('for', 'month')
    .text('Month:')

  //month drop down
  var monthSelect = d3.select('#map-container')
    .append('select')
      .attr('class','select')
      .attr('id', 'month')
      .attr('disabled', 'disabled')
      .on('change',onchange)

  var options = monthSelect
    .selectAll('option')
    .data(months).enter()
    .append('option')
    .text(function (d) { return d; });

  //label for day
  var daySelectLabel = d3.select('#map-container')
    .append('label')
    .attr('class', 'select-label')
    .attr('for', 'day')
    .text('Day:')

  //day drop down
  var daySelect = d3.select('#map-container')
    .append('select')
    .attr('class','select')
    .attr('id', 'day')
    .attr('disabled', 'disabled')
    .on('change',onchange)


  var options = daySelect
    .selectAll('option')
    .data(days).enter()
    .append('option')
    .text(function (d) { return d; });


  //function for when drop down is changed
  function onchange() {
    selectYear = d3.select("#year").property("value");
    selectMonth = d3.select("#month").property("value");
    selectDay = d3.select("#day").property("value");

    if(infowindow)
    {
      infowindow.close();
    }
    
    //if month is all, month and day is null, disable day drop down
    if(selectYear == "All"){
      selectYear = null;
      selectMonth = null;
      selectDay = null;
      d3.select("#day").attr('disabled', 'disabled').property('value', 'All');
      d3.select("#month").attr('disabled', 'disabled').property('value', 'All');
    }
    else if(selectMonth == "All")
    {
      selectMonth = null;
      selectDay = null;
      d3.select("#day").attr('disabled', 'disabled').property('value', 'All');
      d3.select("#month").attr('disabled', null);

    }
    //else month is selected, enable day drop down
    else
    {
      d3.select("#day").attr('disabled', null);
      d3.select("#month").attr('disabled', null);

        var newDays = ["All"];
        //push number of days to newDays array, depending on month
        for(var i = 1; i <= monthMaxDayDict[selectMonth]; i++)
        {
          newDays.push(i);
        }
        //change spelt out month with corresponding number
        selectMonth = monthDict[selectMonth];

        //remove previous options
        daySelect.selectAll('option').remove()
        //replace new options
        daySelect.selectAll('option').data(newDays).enter().append('option').text(function (d) { return d; });
        //select day
        d3.select("#day").property("value", selectDay);
    }
    //if select day is all,
    if(selectDay == "All")
    {
      selectDay = null;
    }



    buildHeatmap(selectYear,selectMonth, selectDay);
  };







  // function to find key in array, give correct fill color
  function fillColor(lotCount, lotName, year, month=null, day=null)
  {

    total = 0;
    for(i = 0; i < lotCount.length; i++)
    { 
      if(lotCount[i].key == lotName) 
      {
        for(j = 0; j < lotCount[i].values.length; j++)
          {
              if(year == null){
                  total += lotCount[i].values[j].value;
              }
              else if(year == lotCount[i].values[j].key)
              {
                  if(month != null)
                  {
                      for(k = 0; k < lotCount[i].values[j].values.length; k++)
                      {
                          if (month == lotCount[i].values[j].values[k].key)
                          {
                             if(day != null)
                             {
                                for(l = 0; l < lotCount[i].values[j].values[k].values.length; l++)
                                {
                                  if (day == lotCount[i].values[j].values[k].values[l].key)
                                  {
                                  total += lotCount[i].values[j].values[k].values[l].value;
                                  }
                                }
                             }  
                             else 
                             {
                               total = lotCount[i].values[j].values[k].value;
                             }
                          }
                      }
                  }
                  else 
                  {
                    total = lotCount[i].values[j].value;
                  }
              } 
          } 
      }
    }
    // console.log(total);
    return total;
  }

  var infowindow = new google.maps.InfoWindow({
    content: ''
  });


  function maxGradient(lotCount, year, month, day)
  {
    

    currentMax = 0;
    for(i = 0; i < lotCount.length; i++)
    { 
      if(year == null) {
         if(lotCount[i].value > currentMax)
                    {
                      currentMax = lotCount[i].value;
                    }
      }
      else {
        for(j = 0; j < lotCount[i].values.length; j++)
          {
              if(year == lotCount[i].values[j].key)
              {
                  if(month != null)
                  {
                      for(k = 0; k < lotCount[i].values[j].values.length; k++)
                      {
                          if (month == lotCount[i].values[j].values[k].key)
                          {
                             if(day != null)
                             {
                                for(l = 0; l < lotCount[i].values[j].values[k].values.length; l++)
                                {
                                  if (day == lotCount[i].values[j].values[k].values[l].key)
                                  {
                                    if(lotCount[i].values[j].values[k].values[l].value > currentMax)
                                    {
                                      currentMax = lotCount[i].values[j].values[k].values[l].value;
                                    }

                                  }
                                }
                             }  
                             else 
                             {
                               if(lotCount[i].values[j].values[k].value > currentMax)
                               {
                                currentMax = lotCount[i].values[j].values[k].value;
                               }
                             }
                          }
                      }
                  }
              else 
              {
                    if(lotCount[i].values[j].value > currentMax)
                    {
                      currentMax = lotCount[i].values[j].value
                    }         
                  } 
              } 
      }
    }
  }
    return currentMax;

  }

  function buildLegend(max, newgradient)
  {
    //clear old legend
    d3.select('svg').remove();
    d3.selectAll('.legend-keys').remove();

    d3.select('#gradient').append('text').attr('class', 'legend-keys').text('0');
    d3.select('#gradient').append('svg');

    var vis = d3.select('svg')
     
    vis
    .attr('height', 40)
    //var colorScale = newgradient;
     var colorScale = d3.scaleLinear().domain([0, 25, 50, 75, 100])
       .range(["light blue", "cyan", "green", "yellow", "red"])
    var xScale = d3.scaleLinear().domain([0, 100]).range([0, 300])

    var arr = d3.range(101);
    vis.selectAll('rect').data(arr).enter()
    .append('rect')
    .attr('x', function(d) { return xScale(d) })
          .attr('y', 20)
          .attr('height', 20)
          .attr('width', 5)
          .attr('fill', function(d) { return colorScale(d) })

      d3.select('#gradient').append('text').attr('class','legend-keys').text(max);
  }



  //function to get rid of precious polygons and then add new ones
   function buildHeatmap(year=null, month=null, day=null){
    //Did they select a year only?
    yearOnly = month == null && day == null;
    //did they select a year and a month?
    yearAndMonth = day == null;

      maxGradient1 = maxGradient(year == null ? lotsRolledUp : (yearOnly?lotsRolledUpY:(yearAndMonth?lotsRolledUpM:lotsRolledUpD)), year, month, day);
    
    buildLegend(maxGradient1, gradient);

    //need function to find highest number 
  var gradient = d3.scaleLinear().domain([0, maxGradient1 * 0.25, maxGradient1 * 0.50, maxGradient1 * 0.75, maxGradient1]).range(["LIGHT BLUE", "CYAN", "GREEN", "YELLOW", "RED"]);




    //clear polygons
    for(var i = 0; i < existingPolygons.length; i++){
        existingPolygons[i].setMap(null);
    }


  jacksonAvePoly = new google.maps.Polygon({
    paths: window.LatLng.jacksonAveLatLng,
    fillColor: gradient(fillColor(yearOnly?lotsRolledUpY:(yearAndMonth?lotsRolledUpM:lotsRolledUpD), "JACKSON AVENUE CENTER", year, month, day)),
    fillOpacity: 0.95,
    strokeWeight: 0.6
  });

    sororityPoly = new google.maps.Polygon({
    paths: window.LatLng.sororityLatLng,
    fillColor: gradient(fillColor(yearOnly?lotsRolledUpY:(yearAndMonth?lotsRolledUpM:lotsRolledUpD), "SORORITY LOT", year, month, day)),
    fillOpacity: 0.95,
    strokeWeight: 0.6
   });

    coliseumEastPoly = new google.maps.Polygon({
    paths: window.LatLng.coliseumEastLatLng,
    fillColor: gradient(fillColor(yearOnly?lotsRolledUpY:(yearAndMonth?lotsRolledUpM:lotsRolledUpD), "COLISEUM EAST LOT", year, month, day)),
    fillOpacity: 0.95,
    strokeWeight: 0.6
   });

    crosbyRearPoly = new google.maps.Polygon({
    paths: window.LatLng.crosbyRearLatLng,
    fillColor: gradient(fillColor(yearOnly?lotsRolledUpY:(yearAndMonth?lotsRolledUpM:lotsRolledUpD), "CROSBY REAR LOT", year, month, day)),
    fillOpacity: 0.95,
    strokeWeight: 0.6
  });

    manningCenterPoly = new google.maps.Polygon({
    paths: window.LatLng.manningCenterLatLng,
    fillColor: gradient(fillColor(yearOnly?lotsRolledUpY:(yearAndMonth?lotsRolledUpM:lotsRolledUpD), "MANNING CENTER EAST", year, month, day)),
    fillOpacity: 0.95,
    strokeWeight: 0.6
  });

    residentialCollegePoly = new google.maps.Polygon({
    paths: window.LatLng.residentialCollegeLatLng,
    fillColor: gradient(fillColor(yearOnly?lotsRolledUpY:(yearAndMonth?lotsRolledUpM:lotsRolledUpD), "RESIDENTIAL COLLEGE/ALUMN DR LOT", year, month, day)),
    fillOpacity: 0.95,
    strokeWeight: 0.6
  });

    magnoliaPoly = new google.maps.Polygon({
    paths: window.LatLng.magnoliaLatLng,
    fillColor: gradient(fillColor(yearOnly?lotsRolledUpY:(yearAndMonth?lotsRolledUpM:lotsRolledUpD), "MAGNOLIA DRIVE", year, month, day)),
    fillOpacity: 0.95,
    strokeWeight: 0.6
  });

    poolePoly = new google.maps.Polygon({
    paths: [window.LatLng.pooleLatLng1, window.LatLng.pooleLatLng2, window.LatLng.pooleLatLng3, window.LatLng.pooleLatLng4],
    fillColor: gradient(fillColor(yearOnly?lotsRolledUpY:(yearAndMonth?lotsRolledUpM:lotsRolledUpD), "POOLE DRIVE", year, month, day)),
    fillOpacity: 0.95,
    strokeWeight: 0.6
  });
    

    meekPoly = new google.maps.Polygon({
    paths: window.LatLng.meekLatLng,
    fillColor: gradient(fillColor(yearOnly?lotsRolledUpY:(yearAndMonth?lotsRolledUpM:lotsRolledUpD), "MEEK LOT", year, month, day)),
    fillOpacity: 0.95,
    strokeWeight: 0.6
  });

    bishopPoly = new google.maps.Polygon({
    paths: window.LatLng.bishopLatLng,
    fillColor: gradient(fillColor(yearOnly?lotsRolledUpY:(yearAndMonth?lotsRolledUpM:lotsRolledUpD), "BISHOP LOT", year, month, day)),
    fillOpacity: 0.95,
    strokeWeight: 0.6
  });

    fordCenterPoly = new google.maps.Polygon({
    paths: window.LatLng.fordCenterLatLng,
    fillColor: gradient(fillColor(yearOnly?lotsRolledUpY:(yearAndMonth?lotsRolledUpM:lotsRolledUpD), "FORD CENTER LOT", year, month, day)),
    fillOpacity: 0.95,
    strokeWeight: 0.6
  });

  circlePoly = new google.maps.Polygon({
    paths: [window.LatLng.outerCircleLatLng, window.LatLng.innerCircleLatLng],
    fillColor: gradient(fillColor(yearOnly?lotsRolledUpY:(yearAndMonth?lotsRolledUpM:lotsRolledUpD), "CIRCLE", year, month, day)),
    fillOpacity: 0.95,
    strokeWeight: 0.6
  });

  stockardRearPoly = new google.maps.Polygon({
    paths: window.LatLng.stockardRearLatLng,
    fillColor: gradient(fillColor(yearOnly?lotsRolledUpY:(yearAndMonth?lotsRolledUpM:lotsRolledUpD), "STOCKARD REAR LOT", year, month, day)),
    fillOpacity: 0.95,
    strokeWeight: 0.6,
  });

  oldAthleticsPoly = new google.maps.Polygon({
    paths: window.LatLng.oldAthleticsLatLng,
    fillColor: gradient(fillColor(yearOnly?lotsRolledUpY:(yearAndMonth?lotsRolledUpM:lotsRolledUpD), "OLD ATHLETICS F/S", year, month, day)),
    fillOpacity: 0.95,
    strokeWeight: 0.6
  });

  kincannonPoly = new google.maps.Polygon({
    paths: window.LatLng.kincannonLatLng,
    fillColor: gradient(fillColor(yearOnly?lotsRolledUpY:(yearAndMonth?lotsRolledUpM:lotsRolledUpD), "KINCANNON  HALL PARKING LOT", year, month, day)),
    fillOpacity: 0.95,
    strokeWeight: 0.6
  });

  womensTerraceLowerPoly = new google.maps.Polygon({
    paths: window.LatLng.womensTerraceLowerLatLng,
    fillColor: gradient(fillColor(yearOnly?lotsRolledUpY:(yearAndMonth?lotsRolledUpM:lotsRolledUpD), "WOMENS TERRACE-LOWER LOT", year, month, day)),
    fillOpacity: 0.95,
    strokeWeight: 0.6
  });

  hflFacultyPoly = new google.maps.Polygon({
    paths: window.LatLng.hflFacultyLatLng,
    fillColor: gradient(fillColor(yearOnly?lotsRolledUpY:(yearAndMonth?lotsRolledUpM:lotsRolledUpD), "HFL FACULTY/STAFF", year, month, day)),
    fillOpacity: 0.95,
    strokeWeight: 0.6
  });

  oldAthleticMeterPoly = new google.maps.Polygon({
    paths: window.LatLng.oldAthleticMeterLatLng,
    fillColor: gradient(fillColor(yearOnly?lotsRolledUpY:(yearAndMonth?lotsRolledUpM:lotsRolledUpD), "OLD ATHLETICS METER", year, month, day)),
    fillOpacity: 0.95,
    strokeWeight: 0.6
  });


  dormRowNorthPoly = new google.maps.Polygon({
    paths: [window.LatLng.dormRowNorthLatLng1, window.LatLng.dormRowNorthLatLng2, window.LatLng.dormRowNorthLatLng3],
    fillColor: gradient(fillColor(yearOnly?lotsRolledUpY:(yearAndMonth?lotsRolledUpM:lotsRolledUpD), "DORM ROW NORTH", year, month, day)),
    fillOpacity: 0.95,
    strokeWeight: 0.6
  });

  campusWalkPoly = new google.maps.Polygon({
    paths: [window.LatLng.campusWalkLatLng, window.LatLng.campusWalkHoleLatLng1, window.LatLng.campusWalkHoleLatLng2, window.LatLng.campusWalkHoleLatLng3, window.LatLng.campusWalkHoleLatLng4, window.LatLng.campusWalkHoleLatLng5],
     fillColor: gradient(fillColor(yearOnly?lotsRolledUpY:(yearAndMonth?lotsRolledUpM:lotsRolledUpD), "CAMPUS WALK APT. COMPLEX", year, month, day)),
    fillOpacity: 0.95,
    strokeWeight: 0.6
  });

  ncpaFacultyPoly = new google.maps.Polygon({
    paths: window.LatLng.ncpaFacultyLatLng,
     fillColor: gradient(fillColor(yearOnly?lotsRolledUpY:(yearAndMonth?lotsRolledUpM:lotsRolledUpD), "NCPA FACULTY/STAFF LOT", year, month, day)),
    fillOpacity: 0.95,
    strokeWeight: 0.6
  });

  allAmericanPoly = new google.maps.Polygon({
    paths: window.LatLng.allAmericanLatLng,
     fillColor: gradient(fillColor(yearOnly?lotsRolledUpY:(yearAndMonth?lotsRolledUpM:lotsRolledUpD), "ALL AMERICAN DR.", year, month, day)),
    fillOpacity: 0.95,
    strokeWeight: 0.6
  });

  coliseumWestPoly = new google.maps.Polygon({
    paths: [window.LatLng.coliseumWestLatLng1, window.LatLng.coliseumWestLatLng2, window.LatLng.coliseumWestLatLng3, window.LatLng.coliseumWestLatLng4],
     fillColor: gradient(fillColor(yearOnly?lotsRolledUpY:(yearAndMonth?lotsRolledUpM:lotsRolledUpD), "COLISEUM WEST LOT", year, month, day)),
    fillOpacity: 0.95,
    strokeWeight: 0.6
  });

  womensTerraceUpperPoly = new google.maps.Polygon({
    paths: window.LatLng.womensTerraceUpperLatLng,
     fillColor: gradient(fillColor(yearOnly?lotsRolledUpY:(yearAndMonth?lotsRolledUpM:lotsRolledUpD), "WOMENS TERRACE-UPPER LOT", year, month, day)),
    fillOpacity: 0.95,
    strokeWeight: 0.6
  });

  turnerColiseumPoly = new google.maps.Polygon({
    paths: window.LatLng.turnerColiseumLatLng,
     fillColor: gradient(fillColor(yearOnly?lotsRolledUpY:(yearAndMonth?lotsRolledUpM:lotsRolledUpD), "TURNER COLISEUM LOT", year, month, day)),
    fillOpacity: 0.95,
    strokeWeight: 0.6
  });

  fratAlleyPoly = new google.maps.Polygon({
    paths: [window.LatLng.fratAlleyLatLng1, window.LatLng.fratAlleyLatLng2],
     fillColor: gradient(fillColor(yearOnly?lotsRolledUpY:(yearAndMonth?lotsRolledUpM:lotsRolledUpD), "FRATERNITY ALLEY", year, month, day)),
    fillOpacity: 0.95,
    strokeWeight: 0.6
  });

  theInnPoly = new google.maps.Polygon({
    paths: window.LatLng.theInnLatLng,
     fillColor: gradient(fillColor(yearOnly?lotsRolledUpY:(yearAndMonth?lotsRolledUpM:lotsRolledUpD), "THE INN AT OLE MISS", year, month, day)),
    fillOpacity: 0.95,
    strokeWeight: 0.6
  });




  lotAndLatLngDict = {
    "JACKSON AVENUE CENTER" : new google.maps.LatLng(34.37066853965804, -89.54728603363037),
    "SORORITY LOT" : new google.maps.LatLng(34.369278197455856, -89.5319464802742),
    "COLISEUM EAST LOT" : new google.maps.LatLng(34.36365903178182, -89.539475440979),
    "CROSBY REAR LOT" : new google.maps.LatLng(34.37159984944055, -89.53448116779327),
    "MANNING CENTER EAST" : new google.maps.LatLng(34.36066700781123, -89.53498005867004),
    "RESIDENTIAL COLLEGE/ALUMN DR LOT" : new google.maps.LatLng(34.3679210419447, -89.52936619520187),
    "MAGNOLIA DRIVE" : new google.maps.LatLng(34.36608711253981, -89.54136371612549),
    "MEEK LOT" : new google.maps.LatLng(34.3674288001151, -89.53739404678345),
    "BISHOP LOT" : new google.maps.LatLng(34.365564601387156, -89.53974902629852),
    "FORD CENTER LOT" : new google.maps.LatLng(34.36741994416282, -89.5282906293869),
    "CIRCLE" : new google.maps.LatLng(34.3660295477764, -89.53502297401428),
    "STOCKARD REAR LOT" : new google.maps.LatLng(34.37050618657293, -89.5378178358078),
    "OLD ATHLETICS F/S" : new google.maps.LatLng(34.36398819206313, -89.53863859176636),
    "KINCANNON  HALL PARKING LOT" : new google.maps.LatLng(34.36960364607053, -89.53856885433197),
    "WOMENS TERRACE-LOWER LOT" : new google.maps.LatLng(34.368850906327204, -89.53476279973984),
    "HFL FACULTY/STAFF" : new google.maps.LatLng(34.36704208934999, -89.53857153654099),
    "OLD ATHLETICS METER" : new google.maps.LatLng(34.364292258415695, -89.53848570585251),
    "DORM ROW NORTH" : new google.maps.LatLng(34.36702511524971, -89.5376904308796),
    "CAMPUS WALK APT. COMPLEX" : new google.maps.LatLng(34.364366060716115, -89.54769641160965),
    "NCPA FACULTY/STAFF LOT" : new google.maps.LatLng(34.36204273213624, -89.54077363014221),
    "ALL AMERICAN DR." : new google.maps.LatLng(34.364382666231094, -89.53818965703249),
    "COLISEUM WEST LOT" : new google.maps.LatLng(34.363375037542795, -89.54072856955463),
    "WOMENS TERRACE-UPPER LOT" : new google.maps.LatLng(34.368250923426345, -89.53442215919495),
    "TURNER COLISEUM LOT" : new google.maps.LatLng(34.3626006913775, -89.53744769096375),
    "FRATERNITY ALLEY" : new google.maps.LatLng(34.36462141636153, -89.54166948795319),
    "POOLE DRIVE" : new google.maps.LatLng(34.363890772536365, -89.54178214073181)
  }



  function addInfoWindow(lotName) {
      if(infowindow)
      {
        infowindow.close();
      }

      infowindow.setContent("<div id='iw-container'>" 
        + "<div id='iw-title'>"
        + "<span class='lot-name'>" + lotName + "</span>" 
        + "</div>" 
        + "<div id='iw-content'>Number of Tickets: " + fillColor(yearOnly?lotsRolledUpY:(yearAndMonth?lotsRolledUpM:lotsRolledUpD), lotName, year, month, day) + "</div></div>");

      infowindow.setPosition(lotAndLatLngDict[lotName]);

      infowindow.open(map);
  }


  //Info Window event listeners, every polygon
  google.maps.event.addListener(jacksonAvePoly, 'mouseover', function() {
  addInfoWindow("JACKSON AVENUE CENTER");
  this.setOptions({strokeWeight: 1.6});
  });

  google.maps.event.addListener(jacksonAvePoly, 'mouseout', function() {
  this.setOptions({strokeWeight: 0.6});
  });

  google.maps.event.addListener(sororityPoly, 'mouseover', function() {
  addInfoWindow("SORORITY LOT");
  this.setOptions({strokeWeight: 1.6});
  });
  google.maps.event.addListener(sororityPoly, 'mouseout', function() {
  this.setOptions({strokeWeight: 0.6});
  });

  google.maps.event.addListener(coliseumEastPoly, 'mouseover', function() {
  addInfoWindow("COLISEUM EAST LOT");
  this.setOptions({strokeWeight: 1.6});
  });
  google.maps.event.addListener(coliseumEastPoly, 'mouseout', function() {
  this.setOptions({strokeWeight: 0.6});
  });

  google.maps.event.addListener(crosbyRearPoly, 'mouseover', function() {
  addInfoWindow("CROSBY REAR LOT");
  this.setOptions({strokeWeight: 1.6});
  });
  google.maps.event.addListener(crosbyRearPoly, 'mouseout', function() {
  this.setOptions({strokeWeight: 0.6});
  });

  google.maps.event.addListener(manningCenterPoly, 'mouseover', function() {
    addInfoWindow("MANNING CENTER EAST");
    this.setOptions({strokeWeight: 1.6});
  })
  google.maps.event.addListener(manningCenterPoly, 'mouseout', function() {
  this.setOptions({strokeWeight: 0.6});
  });

  google.maps.event.addListener(residentialCollegePoly, 'mouseover', function() {
    addInfoWindow("RESIDENTIAL COLLEGE/ALUMN DR LOT");
    this.setOptions({strokeWeight: 1.6});
  })
  google.maps.event.addListener(residentialCollegePoly, 'mouseout', function() {
  this.setOptions({strokeWeight: 0.6});
  });

  google.maps.event.addListener(magnoliaPoly, 'mouseover', function() {
    addInfoWindow("MAGNOLIA DRIVE");
    this.setOptions({strokeWeight: 1.6});
  })
  google.maps.event.addListener(magnoliaPoly, 'mouseout', function() {
  this.setOptions({strokeWeight: 0.6});
  });

  google.maps.event.addListener(meekPoly, 'mouseover', function() {
    addInfoWindow("MEEK LOT");
    this.setOptions({strokeWeight: 1.6});
  })
  google.maps.event.addListener(meekPoly, 'mouseout', function() {
  this.setOptions({strokeWeight: 0.6});
  });

  google.maps.event.addListener(bishopPoly, 'mouseover', function() {
    addInfoWindow("BISHOP LOT");
    this.setOptions({strokeWeight: 1.6});
  })
  google.maps.event.addListener(bishopPoly, 'mouseout', function() {
  this.setOptions({strokeWeight: 0.6});
  });

  google.maps.event.addListener(fordCenterPoly, 'mouseover', function() {
    addInfoWindow("FORD CENTER LOT");
    this.setOptions({strokeWeight: 1.6});
  })
  google.maps.event.addListener(fordCenterPoly, 'mouseout', function() {
  this.setOptions({strokeWeight: 0.6});
  });

  google.maps.event.addListener(circlePoly, 'mouseover', function() {
    addInfoWindow("CIRCLE");
    this.setOptions({strokeWeight: 1.6});
  })

  google.maps.event.addListener(circlePoly, 'mouseout', function() {
  this.setOptions({strokeWeight: 0.6});
  });

  google.maps.event.addListener(stockardRearPoly, 'mouseover', function() {
    addInfoWindow("STOCKARD REAR LOT");
    this.setOptions({strokeWeight: 1.6});
  })
  google.maps.event.addListener(stockardRearPoly, 'mouseout', function() {
  this.setOptions({strokeWeight: 0.6});
  });

  google.maps.event.addListener(oldAthleticsPoly, 'mouseover', function() {
    addInfoWindow("OLD ATHLETICS F/S");
    this.setOptions({strokeWeight: 1.6});
  })
  google.maps.event.addListener(oldAthleticsPoly, 'mouseout', function() {
  this.setOptions({strokeWeight: 0.6});
  });

  google.maps.event.addListener(kincannonPoly, 'mouseover', function() {
    addInfoWindow("KINCANNON  HALL PARKING LOT");
    this.setOptions({strokeWeight: 1.6});
  })
  google.maps.event.addListener(kincannonPoly, 'mouseout', function() {
  this.setOptions({strokeWeight: 0.6});
  });

  google.maps.event.addListener(womensTerraceLowerPoly, 'mouseover', function() {
    addInfoWindow("WOMENS TERRACE-LOWER LOT");
    this.setOptions({strokeWeight: 1.6});
  })
  google.maps.event.addListener(womensTerraceLowerPoly, 'mouseout', function() {
  this.setOptions({strokeWeight: 0.6});
  });

  google.maps.event.addListener(hflFacultyPoly, 'mouseover', function() {
    addInfoWindow("HFL FACULTY/STAFF");
    this.setOptions({strokeWeight: 1.6});
  })

  google.maps.event.addListener(hflFacultyPoly, 'mouseout', function() {
  this.setOptions({strokeWeight: 0.6});
  });

  google.maps.event.addListener(oldAthleticMeterPoly, 'mouseover', function() {
    addInfoWindow("OLD ATHLETICS METER");
    this.setOptions({strokeWeight: 1.6});
  })
  google.maps.event.addListener(oldAthleticMeterPoly, 'mouseout', function() {
  this.setOptions({strokeWeight: 0.6});
  });

  google.maps.event.addListener(dormRowNorthPoly, 'mouseover', function() {
  addInfoWindow("DORM ROW NORTH");
  this.setOptions({strokeWeight: 1.6});
  });
  google.maps.event.addListener(dormRowNorthPoly, 'mouseout', function() {
  this.setOptions({strokeWeight: 0.6});
  });

  google.maps.event.addListener(campusWalkPoly, 'mouseover', function() {
  addInfoWindow("CAMPUS WALK APT. COMPLEX");
  this.setOptions({strokeWeight: 1.6});
  });
  google.maps.event.addListener(campusWalkPoly, 'mouseout', function() {
  this.setOptions({strokeWeight: 0.6});
  });

  google.maps.event.addListener(ncpaFacultyPoly, 'mouseover', function() {
  addInfoWindow("NCPA FACULTY/STAFF LOT");
  this.setOptions({strokeWeight: 1.6});
  });
  google.maps.event.addListener(ncpaFacultyPoly, 'mouseout', function() {
  this.setOptions({strokeWeight: 0.6});
  });

  google.maps.event.addListener(allAmericanPoly, 'mouseover', function() {
  addInfoWindow("ALL AMERICAN DR.");
  this.setOptions({strokeWeight: 1.6});
  });
  google.maps.event.addListener(allAmericanPoly, 'mouseout', function() {
  this.setOptions({strokeWeight: 0.6});
  });

  google.maps.event.addListener(coliseumWestPoly, 'mouseover', function() {
  addInfoWindow("COLISEUM WEST LOT");
  this.setOptions({strokeWeight: 1.6});
  });
  google.maps.event.addListener(coliseumWestPoly, 'mouseout', function() {
  this.setOptions({strokeWeight: 0.6});
  });

  google.maps.event.addListener(womensTerraceUpperPoly, 'mouseover', function() {
  addInfoWindow("WOMENS TERRACE-UPPER LOT");
  this.setOptions({strokeWeight: 1.6});
  });
  google.maps.event.addListener(womensTerraceUpperPoly, 'mouseout', function() {
  this.setOptions({strokeWeight: 0.6});
  });

  google.maps.event.addListener(turnerColiseumPoly, 'mouseover', function() {
  addInfoWindow("TURNER COLISEUM LOT");
  this.setOptions({strokeWeight: 1.6});
  });
  google.maps.event.addListener(turnerColiseumPoly, 'mouseout', function() {
  this.setOptions({strokeWeight: 0.6});
  });

  google.maps.event.addListener(fratAlleyPoly, 'mouseover', function() {
  addInfoWindow("FRATERNITY ALLEY");
  this.setOptions({strokeWeight: 1.6});
  });
  google.maps.event.addListener(fratAlleyPoly, 'mouseout', function() {
  this.setOptions({strokeWeight: 0.6});
  });

  google.maps.event.addListener(poolePoly, 'mouseover', function() {
  addInfoWindow("POOLE DRIVE");
  this.setOptions({strokeWeight: 1.6});
  });
  google.maps.event.addListener(poolePoly, 'mouseout', function() {
  this.setOptions({strokeWeight: 0.6});
  });




  //push polygons to existing polygon array
  existingPolygons.push(jacksonAvePoly);
  existingPolygons.push(sororityPoly);
  existingPolygons.push(coliseumEastPoly);
  existingPolygons.push(crosbyRearPoly);
  existingPolygons.push(manningCenterPoly);

  existingPolygons.push(residentialCollegePoly);
  existingPolygons.push(magnoliaPoly);
  existingPolygons.push(poolePoly);
  existingPolygons.push(meekPoly);
  existingPolygons.push(bishopPoly);

  existingPolygons.push(fordCenterPoly);
  existingPolygons.push(circlePoly);
  existingPolygons.push(stockardRearPoly);
  existingPolygons.push(oldAthleticsPoly);
  existingPolygons.push(kincannonPoly);

  existingPolygons.push(womensTerraceLowerPoly);
  existingPolygons.push(hflFacultyPoly);
  existingPolygons.push(oldAthleticMeterPoly);
  existingPolygons.push(dormRowNorthPoly);
  existingPolygons.push(campusWalkPoly);

  existingPolygons.push(ncpaFacultyPoly);
  existingPolygons.push(allAmericanPoly);
  existingPolygons.push(coliseumWestPoly);
  existingPolygons.push(womensTerraceUpperPoly);
  existingPolygons.push(turnerColiseumPoly);

  existingPolygons.push(fratAlleyPoly);
  existingPolygons.push(theInnPoly);


  //bind polygons to map
  jacksonAvePoly.setMap(map);
  sororityPoly.setMap(map);
  coliseumEastPoly.setMap(map);
  crosbyRearPoly.setMap(map);
  manningCenterPoly.setMap(map);

  residentialCollegePoly.setMap(map);
  magnoliaPoly.setMap(map);
  meekPoly.setMap(map);
  poolePoly.setMap(map);
  bishopPoly.setMap(map);

  fordCenterPoly.setMap(map);
  circlePoly.setMap(map);
  stockardRearPoly.setMap(map);
  oldAthleticsPoly.setMap(map);
  kincannonPoly.setMap(map);

  womensTerraceLowerPoly.setMap(map);
  hflFacultyPoly.setMap(map);
  oldAthleticMeterPoly.setMap(map);
  dormRowNorthPoly.setMap(map);
  campusWalkPoly.setMap(map);

  ncpaFacultyPoly.setMap(map);
  allAmericanPoly.setMap(map);
  coliseumWestPoly.setMap(map);
  womensTerraceUpperPoly.setMap(map);
  turnerColiseumPoly.setMap(map);

  fratAlleyPoly.setMap(map);
  theInnPoly.setMap(map);
  
  }

   //init with All
   buildHeatmap(d3.select("#year").property("value") == 'All' ? null : d3.select('#year').property('value'));
  });


  google.maps.event.addDomListener(window, 'resize', function() {
    map.setCenter(new google.maps.LatLng(34.364732, -89.538443));
  });

  </script>
  </div>
  <div id="gradient"></div>
  <div class="compareContainer">
   <div id="myButton">
  <a href="lineGraph.html"><button type="button" class="btn btn-primary btn-lg active" id="myButton" >Compare Parking lots</button></a>
  </div>
</div>
    </body>


  </html>





