<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Heatmaps</title>
    <link rel="stylesheet" href="stylesheets/styles.css">
    <script src="http://maps.google.com/maps/api/js?sensor=True"></script>

  </head>
<body>
<h1>Ole Miss Parking Citation Visualization</h1>
<script type="text/javascript" src="d3.min.js"></script>
<script type="text/javascript" src="d3/d3.min.js"></script>
<script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>
<div id="map-container">
<div id="map"></div>
<script>

var map = new google.maps.Map(d3.select("#map").node(), {
               zoom: 15,
               center: new google.maps.LatLng(34.364732, -89.538443),
               mapTypeId: google.maps.MapTypeId.ROADMAP
             });


d3.csv("Demo1.csv", function(data) {
  var lotCount = d3.nest()
     .key(function(d) {return d.CLM_DESCRIPTION;})
     .rollup(function(v) { return v.length;})
     .entries(data)

  console.log(lotCount)
  // console.log(lotCount[0])
  console.log(lotCount[0].key)
 

// var gradient = d3.scaleSequential().domain([0,10]).interpolator(d3.interpolatePlasma);

var gradient = d3.scaleLinear().domain([0,10]).range(["orange", "red"]);

//function to find key in array, give correct fill color
function fillColor(lotCount, param)
{ 
  for(i = 0; i < lotCount.length; i++)
  {

  if(lotCount[i].key == param) 
    {
      return lotCount[i].value;
    }
  }
}

//Jackson Avenue 
jacksonAveLatLong = 
[
{"lat": 34.36998163682145, "lng":-89.54804563509242},
{"lat": 34.370610387879836, "lng": -89.54699420915858},
{"lat": 34.37082735017804, "lng": -89.54631829248683},
{"lat": 34.37082292238164, "lng": -89.54574966417567},
{"lat": 34.37081406678818, "lng": -89.54507374750392},
{"lat": 34.370495264799516, "lng": -89.54488062845485},
{"lat": 34.37042441974841, "lng": -89.54491817938106},
{"lat": 34.37037128592073, "lng": -89.54498791681544},
{"lat": 34.36889680875947, "lng": -89.54835677133815},
{"lat": 34.368914520350835, "lng": -89.54849624620692},
{"lat": 34.36898979457238, "lng": -89.54860353456752},
{"lat": 34.36945029421982, "lng": -89.54886102663295},
{"lat": 34.369746960921255, "lng": -89.54881811128871},
{"lat": 34.36955213514621, "lng": -89.54840505110042},
{"lat": 34.36998075126676, "lng": -89.5480477809906}
];


jacksonAvePoly = new google.maps.Polygon({
  paths: jacksonAveLatLong,
  strokeColor: '#FF0000',
  strokeOpacity: 0.8,
  strokeWeight: 0,
  // fillColor: gradient(10),
  fillColor: gradient(fillColor(lotCount, "15 MINUTE FORD CENTER")),
  fillOpacity: 0.35
 })

parkingLotCoords2 = [
{"lat": 34.369858, "lng": -89.544057},
{"lat": 34.368981, "lng": -89.544947},
{"lat": 34.368193, "lng": -89.544121},
{"lat": 34.368131, "lng": -89.545097}
];
 

 jacksonAve2 = new google.maps.Polygon({
  paths: parkingLotCoords2,
  strokeColor: '#FF0000',
  strokeOpacity: 0.8,
  strokeWeight: 0,
  fillColor: gradient(2),
  fillOpacity: 0.35
 })

  jacksonAvePoly.setMap(map);
  jacksonAve2.setMap(map);

});
</script>
</div>
  </body>
</html>
